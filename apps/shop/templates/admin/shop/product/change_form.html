{% extends "admin/change_form.html" %}

{% block extrahead %}{{ block.super }}
<style type="text/css">
	
	#show-image-row {margin:10px; font-weight:bold; text-align:right;}
	.create-variations li {list-style-type:none; float:left; margin-right:10px;}
	.create-variations label {width:auto;}
	
</style>
<script type="text/javascript" 
	src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript">

$(function() {
	
	var imagesFieldset = '#id_images-INITIAL_FORMS + fieldset';
	var variationsFieldset = '#id_variations-INITIAL_FORMS + fieldset';
	var variationDefaults = variationsFieldset + ' td.default input:checkbox';
	var addButtonID = 'show-image-row';
	
	// hide all the unused "extra" image field table rows
	$(imagesFieldset + ' tr[class^=row]:not(.has_original)').hide();
	
	// add the add button for showing the next hidden field image field table row
	$(imagesFieldset).append('<p id="' + addButtonID + '"><a href="#">+ ' + 
		gettext('Add new image') + '</a></p>');
		
	// add button click handler - show the next hidden field image table row
	$('#' + addButtonID).click(function() {
		var imageRows = $(imagesFieldset + ' tr:hidden');
		$(imageRows[0]).show();
		if (imageRows.length == 1) {
			$('#' + addButtonID).hide();
		}
		return false;
	});
	
	// move the "create variations" fieldset to under the current variations
	$('.create-variations').insertAfter($(variationsFieldset).parent().parent());
	
	// deselect default variation when another is selected as default
	$(variationDefaults).click(function() {
		var clicked = $(this);
		if (clicked.attr('checked')) {
			$(variationDefaults + '[name!=' + clicked.attr('name') + 
				']').attr('checked', false);
		}
	});

});

</script>
{% endblock %}
